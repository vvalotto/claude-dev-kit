# Claude Dev Kit - ConfiguraciÃ³n de InstalaciÃ³n
# Version: 1.0
#
# Este archivo define los perfiles de instalaciÃ³n para diferentes stacks tecnolÃ³gicos,
# reglas de copia de archivos, y validaciones post-instalaciÃ³n.

version: "1.0"

# =============================================================================
# PERFILES POR STACK TECNOLÃ“GICO
# =============================================================================
# Cada perfil personaliza el framework para un stack especÃ­fico, definiendo:
# - architecture_pattern: PatrÃ³n arquitectÃ³nico del proyecto
# - test_framework: Framework de testing utilizado
# - component_types: Tipos de componentes tÃ­picos del stack
# - patterns: Patrones de diseÃ±o comunes

profiles:
  # ---------------------------------------------------------------------------
  # PyQt + MVC: Aplicaciones de escritorio con PyQt6 y arquitectura MVC
  # ---------------------------------------------------------------------------
  pyqt-mvc:
    name: "PyQt + MVC"
    description: "PyQt6 applications with MVC architecture"
    architecture_pattern: "mvc"
    test_framework: "pytest-qt"

    component_types:
      - "Panel"
      - "Model"
      - "Controller"
      - "Display"

    patterns:
      - "Factory"
      - "Coordinator"
      - "Observer"

    # Variables de placeholder para templates
    variables:
      base_class: "ModeloBase"
      test_base_class: "QWidget"
      import_test_framework: "from pytestqt.qtbot import QtBot"

  # ---------------------------------------------------------------------------
  # FastAPI + REST: APIs REST con FastAPI y arquitectura en capas
  # ---------------------------------------------------------------------------
  fastapi-rest:
    name: "FastAPI + REST"
    description: "FastAPI REST APIs with layered architecture"
    architecture_pattern: "layered"
    test_framework: "pytest"

    component_types:
      - "Router"
      - "Service"
      - "Repository"
      - "Schema"

    patterns:
      - "Dependency Injection"
      - "Repository Pattern"
      - "Service Layer"

    # Variables de placeholder para templates
    variables:
      base_class: "BaseModel"
      test_base_class: "TestClient"
      import_test_framework: "from fastapi.testclient import TestClient"

  # ---------------------------------------------------------------------------
  # Django + MVT: Aplicaciones web Django con patrÃ³n Model-View-Template
  # ---------------------------------------------------------------------------
  django-mvt:
    name: "Django + MVT"
    description: "Django applications with Model-View-Template pattern"
    architecture_pattern: "mvt"
    test_framework: "pytest-django"

    component_types:
      - "Model"
      - "View"
      - "Template"
      - "Form"

    patterns:
      - "MTV Pattern"
      - "Class-Based Views"
      - "Django ORM"

    # Variables de placeholder para templates
    variables:
      base_class: "models.Model"
      test_base_class: "TestCase"
      import_test_framework: "from django.test import TestCase"

  # ---------------------------------------------------------------------------
  # Generic Python: Proyectos Python genÃ©ricos sin framework especÃ­fico
  # ---------------------------------------------------------------------------
  generic-python:
    name: "Generic Python"
    description: "Generic Python projects without specific framework"
    architecture_pattern: "modular"
    test_framework: "pytest"

    component_types:
      - "Module"
      - "Class"
      - "Function"

    patterns:
      - "SOLID Principles"
      - "Design Patterns"

    # Variables de placeholder para templates
    variables:
      base_class: "object"
      test_base_class: "unittest.TestCase"
      import_test_framework: "import pytest"

# =============================================================================
# CONFIGURACIÃ“N DE INSTALACIÃ“N
# =============================================================================
# Define cÃ³mo el instalador copia archivos al proyecto destino

installation:
  # Directorio destino donde se instalarÃ¡ el framework
  target_dir: ".claude"

  # Generar CLAUDE.md si no existe en el proyecto
  create_claude_md: true

  # PolÃ­tica de sobrescritura de archivos existentes
  # Opciones: "ask" (preguntar), "skip" (saltar), "overwrite" (sobrescribir)
  overwrite_policy: "ask"

  # Reglas de copia de archivos/directorios
  copy_rules:
    # Copiar skills al proyecto
    - source: "skills"
      target: "{target_dir}/skills"
      recursive: true
      description: "Skills (implement-us, etc.)"

    # Copiar templates al proyecto
    - source: "templates"
      target: "{target_dir}/templates"
      recursive: true
      description: "Templates (BDD, planning, testing, reporting)"

    # Copiar sistema de tracking al proyecto
    - source: "tracking"
      target: "{target_dir}/tracking"
      recursive: true
      description: "Time tracking system"

  # Archivos a generar durante instalaciÃ³n
  generated_files:
    # Archivo de configuraciÃ³n principal
    - path: "{target_dir}/config.json"
      type: "json"
      description: "Main configuration file (merged base + profile)"

    # CLAUDE.md si no existe
    - path: "CLAUDE.md"
      type: "markdown"
      description: "Project guide for Claude Code"
      only_if_missing: true

# =============================================================================
# VALIDACIÃ“N POST-INSTALACIÃ“N
# =============================================================================
# Define quÃ© debe verificar validate-setup.py despuÃ©s de la instalaciÃ³n

validation:
  # Directorios requeridos (instalaciÃ³n incompleta si faltan)
  required_dirs:
    - ".claude"
    - ".claude/skills"
    - ".claude/skills/implement-us"
    - ".claude/templates"
    - ".claude/templates/bdd"
    - ".claude/templates/planning"
    - ".claude/templates/testing"
    - ".claude/templates/reporting"
    - ".claude/tracking"

  # Archivos requeridos (instalaciÃ³n incompleta si faltan)
  required_files:
    - ".claude/config.json"
    - ".claude/skills/implement-us/SKILL.md"
    - ".claude/tracking/time_tracker.py"
    - ".claude/tracking/commands.py"
    - ".claude/tracking/__init__.py"

  # Archivos opcionales (advertencia si faltan, pero no error)
  optional_files:
    - "CLAUDE.md"
    - ".claude/hooks/save-session.sh"
    - ".claude/hooks/check-session-start.sh"

  # Verificaciones de contenido
  content_checks:
    # Verificar que config.json es JSON vÃ¡lido
    - file: ".claude/config.json"
      type: "json_valid"
      description: "Config JSON is valid"

    # Verificar que config.json tiene keys requeridos
    - file: ".claude/config.json"
      type: "json_has_keys"
      required_keys: ["profile", "version"]
      description: "Config has required keys"

  # Verificaciones de imports Python
  python_imports:
    # Verificar que tracking module se puede importar
    - module: "tracking"
      description: "Tracking module imports correctly"

    - module: "tracking.time_tracker"
      description: "TimeTracker imports correctly"

    - module: "tracking.commands"
      description: "Tracking commands import correctly"

# =============================================================================
# MENSAJES Y TEXTOS
# =============================================================================
# Mensajes mostrados durante la instalaciÃ³n

messages:
  welcome: |
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    ğŸš€ Claude Dev Kit - Installer v1.0
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  profile_selection: |
    Selecciona el perfil para tu proyecto:

    1. PyQt + MVC (pyqt-mvc)
       â””â”€ PyQt6 applications with MVC architecture

    2. FastAPI + REST (fastapi-rest)
       â””â”€ FastAPI REST APIs with layered architecture

    3. Django + MVT (django-mvt)
       â””â”€ Django applications with Model-View-Template pattern

    4. Generic Python (generic-python)
       â””â”€ Generic Python projects without specific framework

  success: |
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    âœ… InstalaciÃ³n completada exitosamente!
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

    PrÃ³ximos pasos:
    1. Revisar CLAUDE.md generado
    2. Configurar tu proyecto en .claude/config.json
    3. Ejecutar: /implement-us US-001

  validation_running: |
    ğŸ” Ejecutando validaciÃ³n de instalaciÃ³n...

  already_exists: |
    âš ï¸  El directorio .claude/ ya existe.

    Opciones:
    - Usar --force para sobrescribir
    - Eliminar .claude/ manualmente
    - Cancelar instalaciÃ³n
